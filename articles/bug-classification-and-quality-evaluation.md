---
title: "「バグ分類に合わせた品質評価」レポ"
emoji: ":bug:"
type: "tech"
topics:
  - "test"
published: true
---

:::message alert
イベント参加中にとったメモほぼそのままなので構成が読みにくかったり誤字脱字があったりしますが、とりあえずあげてしまってシフトライトで修正していきます。。。
:::

名古屋大学大学院情報学研究科　森崎修司　准教授

## バグ分類と品質評価
バグ分類＝欠陥タイプ
起こりそうなバグ、問題のカテゴリを作り、それに応じて見つける方法を考える
防ぐのと見つけるのを両方合わせて品質評価という
例：境界値分析（経験則）
境界値を間違えやすい→境界値をテストするとバグを見つけやすい
18歳未満なら未成年、18歳以上なら成年

仕様を書いた時点で自動生成できるようなコードなら境界値分析ではあまりバグは見つからない

左から右に時間が流れる時間軸を想定し
プログラムを書く時点（バグの混入）→コードレビュー→テスト

仕様とプログラムで条件分岐が一致しない
ペアプロで未然防止
条件分岐の境界値をコードレビューで検出

こういうミスが起こるという経験値がある
ミスがなければ境界値テストの効果は下がる
仕様をもとに手でコードを書くとミスが起こりやすい

検出の手間や影響の大きさなどから合理的な検出方法を検討する

さまざまな品質評価方法
自動生成、ペアプロ、ユニットテスト、コードレビュー、システムテスト、ABテスト、カナリアリリース、リリース後のフィードバック
テストのシフトレフトシフトライトはシステムテスト〜フィードバック
テストアーリーだとユニットテストから

いつやるかの判断を明示的にやるといい

例
アクセス集中時に不安定になる
事前見積もり、プロトタイプ、アーキテクチャレビュー、コートレビュ、ストレステスト、ABリリース、段階的リリース、リリース後に怒られる

### 品質評価方法の選択
簡単に検出（評価）できるか
低コストで検出（評価）できるか
リスク低減ユーザ価値向上につながるか
物によっては使い勝手が悪いのは実際に使ってもらわないとわからないのでシフトライトするか
しかし悪いものをリリースしたくないシフトレフトしたい
リスクやコストの合理性から考える

### バグ分類の設定方法
cf なぜ重大な問題を見逃すのか

バグ分類を直接選定する方法
#### 過去で見つけたのと同じようなバグを見つける
- 過去の指摘リストからカードを含む指摘を検索
似てる内容の指摘をまとめてバグ分類にすることで力を入れて品質評価方法とする

- 類似アーキテクチャから見つける
A系統、B系統2つの統括があり、DBにまとめるようなシステム
バグが起こりやすい場所がある
小売業のシステムでも車載システムでもアーキテクチャが同じなら起こり得るバグも似ている

### 保証すべき内容を明らかにし、それを損なうバグ分類を選ぶ
- ドメインの観点から補償すべき内容から設定
システムの価値
予約と対応する座席に過不足がない　当たり前だけどすごく大事
短時間で予約できる
長いスパンで保守できる
これらが阻害されていないか？

## 事例
- プログラミングで注意が必要な部分をモデル図から特定
７製品のテストで見つかったバグから注意が必要な箇所をテク邸
モデル図から注意すべきところが次もわかるのでコーディングするときに気をつける

- 自動車の自動運転ソフトウェア開発
テストフェーズごとにどんな分類か考える
単体テストで見つかるバグを車載テストで見つけると勿体無い
シフトレフトする
乗り心地はシフトライトかな
CIで登録順ではなくバグが見つかりそうなテストを優先実行するとテスト時間が短縮できる

- 可読性の度合いからリファクタリングの優先順位見極め
デザパタ導入と命名の問題があるコードどちらが読みにくいか
名前に門外がある方が複雑な構造より読み間違える
読解時の読みにくさの感覚は逆
読みやすいと感じるからと言って読み間違えないとは限らない！

## QA
- 発生したバグの分類はどのような基準で行うか
発生した順に具体例から抽象化していく→要因別

- どのタイミングでテストするかのトレードオフをどう考えるか
修正コストが大きい、修正時間がかかるなどプロダクトの特性に応じて

- LLMを品質評価に使えるか
使える（詳細は機密）

- 今日か位置分析の同値分割
分割基準は文献に書かれているが吟味が必要

- 分類の設定方法として事業に適したアプローチはあるか
どういうメンバーでやるか、委託するか、合意がしやすいかといった開発体制によって変わる
複数人になることで必要な手続きが増えたりする

- どのような基準で検出可能と判断するか
検出方法が設計できれば検出可能と判断する

- 静的解析が示すバグ可能性をどこまで分類するか
晴れてても傘を持っていくのが安全
静的解析はそちら寄り

- アジャイルでどうやってバグ分類するか
現在進行形で困ってる

- バグ分析の頻度
あまりやりすぎるとしんどい
気づいたときにちょくちょくやる
開発の仕方や体制が変わった、機能が変わってしばらくしてからやる

- 使用ドキュメントがなくQAのキャッチアップの時間がかかる
先に重要なところを教えて重点的にやってもらう
- シフトレフトの検討ばかりでシフトライトの話が出ない
シフトライトの話はリリース前に考えても仕方ないと合意しやすいものから
見つかっても大したことがないUIの違いなどから

- 開発側と品質保証側の視点をうまく組み合わせて方向を一致させるには
ユーザーにとっての価値について合意する

- カナリアリリースでバグが見つかった場合どこまで戻すかにルールはあるか
ルールはないので合意するしかない
戻しやすさで決める
さっさと戻した方が早く一時対策できる
根本的な対策は別の時間軸で考える
論文で検証されたルールはない
「30分間のエラーレートがN％以上ならここまでロールバックするルールにしている」というコメントが

参考文献
https://note.com/smorisaki/n/ndc7f5b106ce2
